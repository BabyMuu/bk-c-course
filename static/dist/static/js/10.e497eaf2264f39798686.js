(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{142:function(t,e,i){"use strict";i.r(e);var n=i(143);var s=i.n(n);for(var a in n)if(a!=="default")(function(t){i.d(e,t,function(){return n[t]})})(a);e["default"]=s.a},143:function(t,e,i){"use strict";var n=i(0);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var s=n(i(15));var a=n(i(16));var o=n(i(147));var r=n(i(148));var l=n(i(149));var u=n(i(150));var p=n(i(151));var d={components:{QuestionRadio:o.default,QuestionMulti:r.default,QuestionJudge:l.default,QuestionShort:u.default,QuestionFill:p.default},data:function t(){return{Dict:{SINGLE:"QuestionRadio",MULTIPLE:"QuestionMulti",COMPLETION:"QuestionFill",JUDGE:"QuestionJudge",SHORT_ANSWER:"QuestionShort"},editQuestion:{visable:false,Question:null},papertree:[{name:"试卷",title:"试卷",flag:0,expanded:true,openedIcon:"icon-folder-open",closedIcon:"icon-folder",id:1,children:[]}],questionlist:[],existlist:[],dragSort:true,dialogsetting:{visible:false,position:{top:100}},sidesliderSettings:{isShow:false,title:"大题信息"},pagination:{current:1,count:undefined,limit:15},questionparameter:{questiontype:undefined,score:0},append:{questiontitle:undefined},rules:{questiontitle:[{required:true,message:"大题名称不能为空！",trigger:"change"},{max:10,message:"不能多于10个字符",trigger:"change"}]},paperquestiontype:[],paperquestiontypeMap:{},typeFilters:[{text:"单选题",value:"单选题"},{text:"多选题",value:"多选题"},{text:"填空题",value:"填空题"},{text:"判断题",value:"判断题"},{text:"简答题",value:"简答题"}],statusFilters:[{text:"未录入",value:"未录入"},{text:"已录入",value:"已录入"}],titilevalue:undefined,firstrow:undefined,popbutton:true,moveoutbutton:true,isdiabled:true}},computed:{CourseId:function t(){return this.$store.state.currentCourseId}},watch:{firstrow:{handler:function t(){if(this.firstrow==="未录入"){this.popbutton=false;this.moveoutbutton=true}if(this.firstrow==="已录入"){this.popbutton=true;this.moveoutbutton=false}if(this.firstrow===undefined){this.popbutton=true;this.moveoutbutton=true}}},CourseId:{handler:function t(){this.$router.push({name:"displaypaper"})}}},created:function t(){this.getquestiontitle()},methods:{clicknode:function t(e){this.editQuestion.Question=e.dialogdata;this.editQuestion.visable=true},handleRowClick:function t(e,i,n,s,a){this.editQuestion.Question=e;this.editQuestion.visable=true},tpl:function t(e,i){var n=this;var s=this.$createElement;var a="node-title";if(e.flag===1){return s("span",[s("span",{class:"delete-button",on:{click:function t(){return n.deltitlenode(e)}}},["-"]),s("span",{class:a,domProps:{innerHTML:e.title},on:{click:function t(){return n.clicknode(e)}}})])}if(e.flag===0){return s("span",[s("span",{class:"add-button",on:{click:function t(){return n.addtitlenode()}}},["+"]),s("span",{class:a,domProps:{innerHTML:e.title}})])}},deltitlenode:function t(e){var i=this;console.log(e.id);this.delquestion(e.id).then(function(t){i.$refs.tree.delNode(e.parent,e)})},delquestion:function t(e){var i=this;return(0,a.default)(s.default.mark(function t(){var n;return s.default.wrap(function t(a){while(1){switch(a.prev=a.next){case 0:a.t0=s.default.keys(i.questionlist);case 1:if((a.t1=a.t0()).done){a.next=8;break}n=a.t1.value;if(!(e===i.questionlist[n].QuestionId)){a.next=6;break}i.questionlist[n].status="未录入";return a.abrupt("break",8);case 6:a.next=1;break;case 8:case"end":return a.stop()}}},t)}))()},addtitlenode:function t(){this.dialogsetting.visible=true},confirmtitle:function t(){var e={val:""};for(var i in this.paperquestiontype){if(this.titilevalue===this.paperquestiontype[i].id){e.val=this.paperquestiontype[i].name;break}}this.papertree[0].children.push({name:e.val,title:e.val,flag:1,openedIcon:"icon-folder-open",closedIcon:"icon-folder",expanded:true,id:this.titilevalue,children:[]});this.titilevalue=undefined;this.papertree[0].expanded=true},judge:function t(){var e={value:0};for(var i in this.Selections){if(this.Selections[0].status!==this.Selections[i].status){e.value=1;break}}if(e.value===1){this.$refs.table.clearSelection();this.Selections=undefined;this.$bkMessage({message:"所选择题目状态不相同，已自动取消选择",theme:"warning"})}},selectEnable:function t(e,i){if(this.firstrow!==undefined){if(e.status!==this.firstrow){return false}else{return true}}else{return true}},clearFilter:function t(){this.$refs.table.clearFilter()},typeFilterMethod:function t(e,i,n){var s=n.property;return i[s]===e},statusFilterMethod:function t(e,i,n){var s=n.property;return i[s]===e},handleSelectionChange:function t(e){this.Selections=e;if(this.Selections.length>0){this.firstrow=this.Selections[0].status}else{this.firstrow=undefined}this.judge()},popquestion:function t(){var e={value:0};if(this.Selections.length>0){if(this.questionparameter.questiontype===undefined){this.$bkInfo({type:"warning",title:"请先选择所属题型"});e.value=1}else if(this.questionparameter.score===0){this.$bkInfo({type:"warning",title:"请设置分数"});e.value=1}}else{this.$bkInfo({type:"warning",title:"请先选择题目"})}if(e.value===0){var i=this;this.$bkInfo({title:"确定添加入试卷中？",confirmFn:function t(){i.confirmquestion()}})}},pushquestion:function t(){var e=this;this.$bkInfo({title:"确认要移出？",confirmFn:function t(){e.moveout()}})},moveout:function t(){var e={value:0};for(var i in this.Selections){e.value=0;for(var n in this.papertree[0].children){for(var s in this.papertree[0].children[n].children){if(this.papertree[0].children[n].children[s].id===this.Selections[i].QuestionId){this.papertree[0].children[n].children.splice(s,1);this.Selections[i].status="未录入";e.value=1;break}}if(e.value===1){break}}}this.firstrow=undefined;this.$refs.table.clearSelection()},confirmquestion:function t(){for(var e in this.papertree[0].children){if(this.questionparameter.questiontype===this.papertree[0].children[e].name){for(var i in this.Selections){this.Selections[i].status="已录入";if(this.Selections[i].question.length>14){var n=this.Selections[i].question.substr(0,13)+"...";this.papertree[0].children[e].children.push({id:this.Selections[i].QuestionId,title:n,name:this.Selections[i].question,flag:1,icon:"icon-file",score:this.questionparameter.score,dialogdata:{explain:this.Selections[i].explain,option_A:this.Selections[i].option_A,option_B:this.Selections[i].option_B,option_C:this.Selections[i].option_C,option_D:this.Selections[i].option_D,option_E:this.Selections[i].option_E,answer:this.Selections[i].answer,types:this.Selections[i].types,question:this.Selections[i].question}})}else{this.papertree[0].children[e].children.push({id:this.Selections[i].QuestionId,title:this.Selections[i].question,name:this.Selections[i].question,flag:1,icon:"icon-file",score:this.questionparameter.score,dialogdata:{explain:this.Selections[i].explain,option_A:this.Selections[i].option_A,option_B:this.Selections[i].option_B,option_C:this.Selections[i].option_C,option_D:this.Selections[i].option_D,option_E:this.Selections[i].option_E,answer:this.Selections[i].answer,types:this.Selections[i].types,question:this.Selections[i].question}})}}this.firstrow=undefined;this.$refs.table.clearSelection()}}},modifiytype:function t(){this.sidesliderSettings.isShow=true},tableRowClassName:function t(e){var i=e.row,n=e.rowIndex;if(i.status==="已录入"){return"success-row"}},addtitle:function t(){var e=this;this.$refs.appendSection.validate().then(function(t){e.savetitle()},function(t){e.$bkMessage({message:"输入有误",theme:"warning"})})},savepaper:function t(){var e=[];for(var i in this.papertree[0].children){var n=[];var s=[];var a={};for(var o in this.papertree[0].children[i].children){n.push(this.papertree[0].children[i].children[o].id);s.push(this.papertree[0].children[i].children[o].score)}this.$set(a,this.papertree[0].children[i].id,[n,s]);e.push(a)}this.updatepaper(e)},getquetionlist:function t(){var e=this;return(0,a.default)(s.default.mark(function t(){return s.default.wrap(function t(i){while(1){switch(i.prev=i.next){case 0:e.$http.get("/course/get_question_list/",{params:{course_id:e.CourseId,chapter_id:e.$route.query.chapterid}}).then(function(t){e.questionlist=[];if(t.data.length!==0){var i={SINGLE:"单选题",MULTIPLE:"多选题",JUDGE:"判断题",COMPLETION:"填空题",SHORT_ANSWER:"简答题"};for(var n in t.data){if(e.existlist.indexOf(t.data[n].question_id)===-1){e.questionlist.push({explain:t.data[n].explain,option_A:t.data[n].option_A,option_B:t.data[n].option_B,option_C:t.data[n].option_C,option_D:t.data[n].option_D,option_E:t.data[n].option_E,answer:t.data[n].answer,types:t.data[n].types,question:t.data[n].question,QuestionId:t.data[n].question_id,type:i[t.data[n].types],status:"未录入"})}else{e.questionlist.push({explain:t.data[n].explain,option_A:t.data[n].option_A,option_B:t.data[n].option_B,option_C:t.data[n].option_C,option_D:t.data[n].option_D,option_E:t.data[n].option_E,answer:t.data[n].answer,types:t.data[n].types,QuestionId:t.data[n].question_id,question:t.data[n].question,type:i[t.data[n].types],status:"已录入"})}}}});case 1:case"end":return i.stop()}}},t)}))()},savetitle:function t(){var e=this;return(0,a.default)(s.default.mark(function t(){var i;return s.default.wrap(function t(n){while(1){switch(n.prev=n.next){case 0:i={course_id:e.CourseId,custom_type_info:[{custom_type_name:e.append.questiontitle}]};e.$http.post("/course/question_title/",i).then(function(t){if(t.result===true){e.$bkMessage({message:"添加成功",theme:"success"});e.getquestiontitle()}});case 2:case"end":return n.stop()}}},t)}))()},getquestiontitle:function t(){var e=this;return(0,a.default)(s.default.mark(function t(){return s.default.wrap(function t(i){while(1){switch(i.prev=i.next){case 0:e.$http.get("/course/question_title/",{params:{course_id:e.CourseId}}).then(function(t){if(t.result===true){e.paperquestiontype=[];for(var i in t.data.custom_types){e.$set(e.paperquestiontypeMap,t.data.custom_types[i].custom_type_name,t.data.custom_types[i].id);e.paperquestiontype.push({name:t.data.custom_types[i].custom_type_name,id:t.data.custom_types[i].id})}}}).then(function(t){e.getpaperinfo()});case 1:case"end":return i.stop()}}},t)}))()},getpaperinfo:function t(){var e=this;return(0,a.default)(s.default.mark(function t(){return s.default.wrap(function t(i){while(1){switch(i.prev=i.next){case 0:e.$http.get("/course/manage_paper_question_contact/",{params:{paper_id:e.$route.query.paperid}}).then(function(t){if(t.result===true){var i={val:0};e.existlist=[];e.papertree[0].id=e.$route.query.paperid;for(var n in t.data){var s=[];for(var a in t.data[n]){e.$set(e.existlist,i.val++,t.data[n][a].question_id);if(t.data[n][a].question.length>14){var o=t.data[n][a].question.substr(0,13)+"...";s.push({id:t.data[n][a].question_id,title:o,name:t.data[n][a].question,flag:1,icon:"icon-file",score:t.data[n][a].score,dialogdata:{explain:t.data[n][a].explain,option_A:t.data[n][a].option_A,option_B:t.data[n][a].option_B,option_C:t.data[n][a].option_C,option_D:t.data[n][a].option_D,option_E:t.data[n][a].option_E,answer:t.data[n][a].answer,types:t.data[n][a].types,question:t.data[n][a].question}})}else{s.push({id:t.data[n][a].question_id,title:t.data[n][a].question,name:t.data[n][a].question,flag:1,icon:"icon-file",score:t.data[n][a].score,dialogdata:{explain:t.data[n][a].explain,option_A:t.data[n][a].option_A,option_B:t.data[n][a].option_B,option_C:t.data[n][a].option_C,option_D:t.data[n][a].option_D,option_E:t.data[n][a].option_E,answer:t.data[n][a].answer,types:t.data[n][a].types,question:t.data[n][a].question}})}}e.papertree[0].children.push({name:n,title:n,openedIcon:"icon-folder-open",closedIcon:"icon-folder",expanded:true,flag:1,id:e.paperquestiontypeMap[n],children:s})}}else{if(t.message==="卷子没有题目"){e.$bkMessage({message:t.message,theme:"warning"})}else{e.$bkMessage({message:t.message,theme:"error"})}}}).then(function(t){e.getquetionlist()});case 1:case"end":return i.stop()}}},t)}))()},updatepaper:function t(e){var i=this;return(0,a.default)(s.default.mark(function t(){return s.default.wrap(function t(n){while(1){switch(n.prev=n.next){case 0:i.$http.post("/course/manage_paper_question_contact/",{paper_id:i.$route.query.paperid,paper_info:e}).then(function(t){if(t.result===true){i.$bkMessage({message:t.message,theme:"success"})}else{i.$bkMessage({message:t.message,theme:"error"})}});case 1:case"end":return n.stop()}}},t)}))()}}};e.default=d},144:function(t,e,i){},178:function(t,e,i){"use strict";var n=i(144);var s=i.n(n);var a=s.a},190:function(t,e,i){"use strict";var n=function(){var t=this;var e=t.$createElement;var i=t._self._c||e;return i("div",{staticStyle:{display:"flex"}},[i("bk-dialog",{attrs:{width:"1200",draggable:false,"show-footer":false},model:{value:t.editQuestion.visable,callback:function(e){t.$set(t.editQuestion,"visable",e)},expression:"editQuestion.visable"}},[t.editQuestion.visable?i(t.Dict[t.editQuestion.Question.types],{tag:"component",attrs:{info:t.editQuestion.Question,editable:true,readonly:true},on:{updateQuestion:t.updateQuestion}}):t._e()],1),t._v(" "),i("bk-sideslider",{attrs:{"is-show":t.sidesliderSettings.isShow,"quick-close":true},on:{"update:isShow":function(e){t.$set(t.sidesliderSettings,"isShow",e)}}},[i("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.sidesliderSettings.title))]),t._v(" "),i("div",{attrs:{slot:"content"},slot:"content"},[i("bk-form",{ref:"appendSection",attrs:{rules:t.rules,model:t.append,"label-width":0}},[i("div",{staticStyle:{"margin-top":"5px","margin-bottom":"5px"}},[i("bk-form-item",{attrs:{"error-display-type":"normal",property:"questiontitle"}},[i("bk-input",{ref:"appendInput",staticStyle:{width:"231px"},attrs:{clearable:false},model:{value:t.append.questiontitle,callback:function(e){t.$set(t.append,"questiontitle",e)},expression:"append.questiontitle"}}),t._v(" "),i("bk-button",{staticClass:"mr10",staticStyle:{display:"inline-block"},attrs:{theme:"primary",title:"主要按钮",icon:"plus"},on:{click:t.addtitle}},[t._v("\n                            新增大题\n                        ")])],1)],1)]),t._v(" "),i("div",{staticClass:"sections"},[i("bk-table",{attrs:{data:t.paperquestiontype,size:t.size,"outer-border":true,"virtual-render":false,"show-header":false,height:"480"},on:{"row-dblclick":t.handleRowDbclick,"selection-change":t.handleSelectChange}},[i("bk-table-column",{attrs:{label:"章节",prop:"name",sortable:""},on:{"row-dblclick":t.handleRowDbclickSection},scopedSlots:t._u([{key:"default",fn:function(e){return[i("bk-input",{ref:"myinput",staticClass:"input",staticStyle:{display:"inline-block"},attrs:{readonly:""},model:{value:e.row.name,callback:function(i){t.$set(e.row,"name",i)},expression:"props.row.name"}})]}}])})],1)],1)],1)]),t._v(" "),i("bk-dialog",{attrs:{width:"300",position:t.dialogsetting.position,title:"添加大题"},on:{confirm:t.confirmtitle},model:{value:t.dialogsetting.visible,callback:function(e){t.$set(t.dialogsetting,"visible",e)},expression:"dialogsetting.visible"}},[i("bk-select",{staticStyle:{width:"250px"},attrs:{disabled:false,"ext-cls":"select-custom","ext-popover-cls":"select-popover-custom",searchable:""},model:{value:t.titilevalue,callback:function(e){t.titilevalue=e},expression:"titilevalue"}},t._l(t.paperquestiontype,function(t){return i("bk-option",{key:t.id,attrs:{id:t.id,name:t.name}})}),1)],1),t._v(" "),i("div",{staticClass:"left"},[i("div",[i("span",{staticStyle:{display:"inline-block"}},[t._v("所属大题：")]),t._v(" "),i("bk-select",{staticClass:"type-select",attrs:{searchable:""},model:{value:t.questionparameter.questiontype,callback:function(e){t.$set(t.questionparameter,"questiontype",e)},expression:"questionparameter.questiontype"}},t._l(t.papertree[0].children,function(t){return i("bk-option",{key:t.id,attrs:{id:t.name,name:t.name}})}),1),t._v(" "),i("span",{staticStyle:{display:"inline-block"}},[t._v("请设置分数：")]),t._v(" "),i("bk-input",{staticStyle:{width:"200px"},attrs:{type:"number",max:100,min:0,precision:t.precision},model:{value:t.questionparameter.score,callback:function(e){t.$set(t.questionparameter,"score",e)},expression:"questionparameter.score"}}),t._v(" "),i("bk-button",{attrs:{theme:"primary",disabled:t.popbutton},on:{click:t.popquestion}},[t._v("录入卷子")]),t._v(" "),i("bk-button",{attrs:{theme:"primary",disabled:t.moveoutbutton},on:{click:t.moveout}},[t._v("移出卷子")])],1),t._v(" "),i("bk-table",{ref:"table",staticStyle:{width:"800px"},attrs:{height:480,data:t.questionlist,"row-class-name":t.tableRowClassName},on:{setCurrentRow:function(e){t.setCurrentRow(t.row)},"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[i("bk-table-column",{attrs:{selectable:t.selectEnable,type:"selection",width:"30"}}),t._v(" "),i("bk-table-column",{attrs:{label:"题目",prop:"question"}}),t._v(" "),i("bk-table-column",{attrs:{filters:t.typeFilters,"filter-method":t.typeFilterMethod,label:"题目类型",prop:"type"}}),t._v(" "),i("bk-table-column",{attrs:{filters:t.statusFilters,"filter-method":t.statusFilterMethod,label:"状态",prop:"status"}})],1)],1),t._v(" "),i("div",{staticClass:"right"},[i("bk-button",{attrs:{theme:"primary"},on:{click:t.modifiytype}},[t._v("新增大题")]),t._v(" "),i("bk-tree",{ref:"tree",attrs:{data:t.papertree,"node-key":"id",draggable:true,"drag-sort":t.dragSort,"has-border":true,tpl:t.tpl},on:{"on-click":t.clicknode}}),t._v(" "),i("bk-button",{attrs:{theme:"primary"},on:{click:t.previewpaper}},[t._v("预览试卷")]),t._v(" "),i("bk-button",{attrs:{theme:"primary"},on:{click:t.savepaper}},[t._v("保存试卷")])],1)],1)};var s=[];i.d(e,"a",function(){return n});i.d(e,"b",function(){return s})},86:function(t,e,i){"use strict";i.r(e);var n=i(190);var s=i(142);for(var a in s)if(a!=="default")(function(t){i.d(e,t,function(){return s[t]})})(a);var o=i(178);var r=i(2);var l=Object(r["a"])(s["default"],n["a"],n["b"],false,null,null,null);e["default"]=l.exports}}]);